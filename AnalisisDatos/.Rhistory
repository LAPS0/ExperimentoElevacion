ungroup()
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(results_tblrange)
results_tblrange <- results_tbl %>%
group_by(subject) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(results_tblrange)
results_tblrange <- results_tbl %>%
group_by(subject) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(results_tblrange)
results_tblrange <- results_tbl %>%
group_by(target_distance,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(results_tblrange)
library(tidyverse)
library(lme4)
library(nlme)
library(sjPlot)
library(MuMIn)
library(ggstatsplot)
library(ggpubr)
library(ggpp)
rm(list=ls())
figures_folder = "figuras"
results_tbl <- read.csv("./DatosUnificados/Dresults_without_outliers_slope_and_intercepto_lin_log.csv", header = TRUE, sep = ',', stringsAsFactors = TRUE)
cbPalette <- c("#000000","#E69F00","#009E73", "#999999", "#D55E00", "#0072B2", "#CC79A7", "#F0E442")
f3 =  ggplot(results_tblp, aes(x = condition,y = mslope, colour = condition, fill = condition)) +
geom_pointrange(aes(x=condition, y=mslope, ymin=mslope-SDslope, ymax=mslope+SDslope),
position = position_dodgenudge(direction = "split", width = 3), size = 1.2)+
geom_line(aes(group = type),position = position_dodgenudge(direction = "split", width = 3),size = 1.2, alpha=.5)+
geom_point(data = results_tbl, mapping = aes(x = condition,y = slope, colour = condition, fill = condition), alpha = .8)+
geom_line(data = results_tbl, mapping = aes(x = condition,y = slope, group = subject, colour = condition, fill = condition),alpha = 0.3)+
scale_colour_manual(values = cbPalette) +
scale_fill_manual(values = cbPalette) +
geom_abline(slope = 0,
intercept = 0,
alpha = 0.5,
linetype = "dashed") +
labs(x = "Condition",
y = "Slope with LM") +
facet_grid(. ~ type) +
annotate("text", x = 1.5, y = 2,  label = "***", size = 4) +
annotate("segment", x = 1, xend = 2, y = 1.9, yend = 1.9, colour = "black", size=.5, alpha=1,)+
theme_pubr(base_size = 12, margin = TRUE)+
theme(legend.position = "none")+
theme(plot.margin = unit(c(0,0.2,0,1), 'lines'))
f3
results_tblp <- results_tbl %>%
group_by(condition, type) %>%
summarise(mslope  = mean(slope,na.rm=TRUE),
SDslope  = sd(slope,na.rm=TRUE),
mintercepto  = mean(intercepto,na.rm=TRUE),
SDintercepto  = sd(intercepto,na.rm=TRUE),)  %>%
ungroup()
setwd("D:/GITHUB/ExperimentoElevacion/AnalisisDatos")
library(tidyverse)
library(lme4)
library(nlme)
library(sjPlot)
library(MuMIn)
library(ggstatsplot)
library(ggpubr)
library(ggpp)
rm(list=ls())
figures_folder = "figuras"
results_tbl <- read.csv("./DatosUnificados/Dresults_without_outliers_slope_and_intercepto_lin_log.csv", header = TRUE, sep = ',', stringsAsFactors = TRUE)
cbPalette <- c("#000000","#E69F00","#009E73", "#999999", "#D55E00", "#0072B2", "#CC79A7", "#F0E442")
results_tblp <- results_tbl %>%
group_by(condition, type) %>%
summarise(mslope  = mean(slope,na.rm=TRUE),
SDslope  = sd(slope,na.rm=TRUE),
mintercepto  = mean(intercepto,na.rm=TRUE),
SDintercepto  = sd(intercepto,na.rm=TRUE),)  %>%
ungroup()
f3 =  ggplot(results_tblp, aes(x = condition,y = mslope, colour = condition, fill = condition)) +
geom_pointrange(aes(x=condition, y=mslope, ymin=mslope-SDslope, ymax=mslope+SDslope),
position = position_dodgenudge(direction = "split", width = 3), size = 1.2)+
geom_line(aes(group = type),position = position_dodgenudge(direction = "split", width = 3),size = 1.2, alpha=.5)+
geom_point(data = results_tbl, mapping = aes(x = condition,y = slope, colour = condition, fill = condition), alpha = .8)+
geom_line(data = results_tbl, mapping = aes(x = condition,y = slope, group = subject, colour = condition, fill = condition),alpha = 0.3)+
scale_colour_manual(values = cbPalette) +
scale_fill_manual(values = cbPalette) +
geom_abline(slope = 0,
intercept = 0,
alpha = 0.5,
linetype = "dashed") +
labs(x = "Condition",
y = "Slope with LM") +
facet_grid(. ~ type) +
annotate("text", x = 1.5, y = 2,  label = "***", size = 4) +
annotate("segment", x = 1, xend = 2, y = 1.9, yend = 1.9, colour = "black", size=.5, alpha=1,)+
theme_pubr(base_size = 12, margin = TRUE)+
theme(legend.position = "none")+
theme(plot.margin = unit(c(0,0.2,0,1), 'lines'))
f3
mi_nombre_de_archivo = paste(figures_folder, .Platform$file.sep, "9. Lm Slope", ".png", sep = '')
t.test(filter(results_tbl,
condition=="Ear level" & type=="NORMAL")$slope,
filter(results_tbl,
condition=="Floor level" & type=="NORMAL")$slope,
paired = TRUE)
aaa <- filter(results_tbl,type == "NORMAL") %>%
group_by(subject,condition) %>%
summarise(mslope  = mean(slope,na.rm=TRUE),
SDslope  = sd(slope,na.rm=TRUE),
mintercepto  = mean(intercepto,na.rm=TRUE),
SDintercepto  = sd(intercepto,na.rm=TRUE),)  %>%
ungroup()
m.RelativBias <- lm(mslope ~ condition,
data = aaa)
extract_stats(ggcoefstats(m.RelativBias))
anova(m.RelativBias)
f4 =  ggplot(results_tblp, aes(x = condition,y = mintercepto, colour = condition, fill = condition)) +
geom_pointrange(aes(x=condition, y=mintercepto, ymin=mintercepto-SDintercepto, ymax=mintercepto+SDintercepto),
position = position_dodgenudge(direction = "split", width = 3), size = 1.2)+
geom_line(aes(group = type),position = position_dodgenudge(direction = "split", width = 3),size = 1.2, alpha=.5)+
geom_point(data = results_tbl, mapping = aes(x = condition,y = intercepto, colour = condition, fill = condition), alpha = .8)+
geom_line(data = results_tbl, mapping = aes(x = condition,y = intercepto, group = subject, colour = condition, fill = condition),alpha = 0.3)+
scale_colour_manual(values = cbPalette) +
scale_fill_manual(values = cbPalette) +
geom_abline(slope = 0,
intercept = 0,
alpha = 0.5,
linetype = "dashed") +
# stat_summary(fun.data = "mean_se",
#              geom = "pointrange",
#              alpha = 1,
#              size = 1,
#              # position = position_dodge(width = 1)
#              position = position_jitterdodge(jitter.width = 0.6,
#                                              jitter.height = 0,
#                                              dodge.width = 0 )) +
# stat_summary(fun.data = "mean_se",
#              geom = "linerange",
#              size=2,
#              position = position_dodge(width = 1)) +
labs(x = "Condition",
y = "Intercepto with LM") +
facet_grid(. ~ type) +
annotate("text", x = 1.5, y = 8,  label = "***", size = 4) +
annotate("segment", x = 1, xend = 2, y = 7.9, yend = 7.9, colour = "black", size=.5, alpha=1,)+
theme_pubr(base_size = 12, margin = TRUE)+
theme(legend.position = "none")+
theme(plot.margin = unit(c(0,0.2,0,1), 'lines'))
f4
t.test(filter(results_tbl,
condition=="Ear level" & type=="ROVED")$slope,
filter(results_tbl,
condition=="Floor level" & type=="ROVED")$slope,
paired = TRUE)
a = results_tbl[results_tbl$target_distance == 6,]
b = results_tbl[results_tbl$target_distance == 2,]
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
results_tblp <- results_tblrange %>%
group_by(condition, type) %>%
summarise(mslope  = mean(range,na.rm=TRUE),
SDslope  = sd(range,na.rm=TRUE)/sqrt(length(range)))  %>%
ungroup()
f5 =  ggplot(results_tblp, aes(x = condition,y = mslope, colour = condition, fill = condition)) +
geom_pointrange(aes(x=condition, y=mslope, ymin=mslope-SDslope, ymax=mslope+SDslope),
position = position_dodgenudge(direction = "split", width = 3), size = 1.2, alpha=.5,shape = 0)+
geom_line(aes(group = type),position = position_dodgenudge(direction = "split", width = 3),size = 1.2)+
geom_point(data = results_tblrange, mapping = aes(x = condition,y = range, colour = condition, fill = condition), alpha = .8)+
geom_line(data = results_tblrange, mapping = aes(x = condition,y = range, group = subject, colour = condition, fill = condition),alpha = 0.3)+
scale_colour_manual(values = cbPalette) +
scale_fill_manual(values = cbPalette) +
geom_abline(slope = 0,
intercept = 0,
alpha = 0.5,
linetype = "dashed") +
labs(x = "Condition",
y = "Range rate") +
facet_grid(. ~ type) +
annotate("text", x = 1.5, y = 2,  label = "***", size = 4) +
annotate("segment", x = 1, xend = 2, y = 1.9, yend = 1.9, colour = "black", size=.5, alpha=1,)+
theme_pubr(base_size = 12, margin = TRUE)+
theme(legend.position = "none")
f5
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
results_tblp <- results_tblrange %>%
group_by(condition, type) %>%
summarise(mslope  = mean(range,na.rm=TRUE),
SDslope  = sd(range,na.rm=TRUE)/sqrt(length(range)))  %>%
ungroup()
results_tblrange <- results_tbl %>%
group_by(subject,condition, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(results_tbl)
a1 <- filter(results_tbl, condition == "floor level") %>%
group_by(subject, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
rm(list=ls())
figures_folder = "figuras"
results_tbl <- read.csv("./DatosUnificados/Dresults_without_outliers_slope_and_intercepto_lin_log.csv", header = TRUE, sep = ',', stringsAsFactors = TRUE)
cbPalette <- c("#000000","#E69F00","#009E73", "#999999", "#D55E00", "#0072B2", "#CC79A7", "#F0E442")
results_tblp <- results_tbl %>%
group_by(condition, type) %>%
summarise(mslope  = mean(slope,na.rm=TRUE),
SDslope  = sd(slope,na.rm=TRUE),
mintercepto  = mean(intercepto,na.rm=TRUE),
SDintercepto  = sd(intercepto,na.rm=TRUE),)  %>%
ungroup()
rm(list=ls())
figures_folder = "figuras"
results_tbl <- read.csv("./DatosUnificados/Dresults_without_outliers_slope_and_intercepto_lin_log.csv", header = TRUE, sep = ',', stringsAsFactors = TRUE)
cbPalette <- c("#000000","#E69F00","#009E73", "#999999", "#D55E00", "#0072B2", "#CC79A7", "#F0E442")
filter(results_tbl, condition == "floor level")
View(results_tbl)
a1 <- filter(results_tbl, condition == "Floor level") %>%
group_by(subject, type) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
filter(results_tbl, condition == "Floor level", type == "NORMAL")
a1 <- filter(results_tbl, condition == "Floor level", type == "NORMAL") %>%
group_by(subject) %>%
summarise(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
a1 <- filter(results_tbl, condition == "Floor level", type == "NORMAL") %>%
group_by(subject) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(a1)
fig_normal = list()
levels(results_tbl$subject)
levels(results_tbl$subject)``
levels(results_tbl$subject)[1]
a1 <- filter(results_tbl, subject == "S002") %>%
group_by(condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
filter(results_tbl, subject == "S002")
a1 <- filter(results_tbl, subject == "S002") %>%
group_by(condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
View(a1)
# i = 2
sub = levels(results_tbl$subject)[1]
a1 <- filter(results_tbl, subject == sub)
View(a1)
# i = 2
sub = levels(results_tbl$subject)[1]
a1 <- filter(results_tbl, subject == sub,target_distance == 6,target_distance == 2)
View(a1)
a1 <- filter(results_tbl, subject == sub, target_distance == 6)
View(a1)
a1 <- filter(results_tbl, subject == sub, target_distance == 6 | target_distance == 2)
View(a1)
a1 <- filter(results_tbl,  target_distance == 6 | target_distance == 2) %>%
ungroup()
View(a1)
a1 <- filter(results_tbl,  target_distance == 6 | target_distance == 2) %>%
group_by(subjetc,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
a1 <- filter(results_tbl,  target_distance == 6 | target_distance == 2) %>%
group_by(subject,condition, type) %>%
reframe(range  = results_tbl[results_tbl$target_distance == 6,]$perc_dist-results_tbl[results_tbl$target_distance == 2,]$perc_dist)  %>%
ungroup()
# i = 2
sub = levels(results_tbl$subject)[1]
a1 <- filter(results_tbl, subject == sub, target_distance == 6 | target_distance == 2)
View(a1)
# i = 2
sub = levels(results_tbl$subject)[1]
a2 <- filter(results_tbl, subject == sub, target_distance == 2)
a6 <- filter(results_tbl, subject == sub, target_distance == 6)
a  =  a6$perc_dist - a2$perc_dist
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
ungroup()
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
reframe()%>%
ungroup()
View(a2)
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
summarise()%>%
ungroup()
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
summarise(perc_dist = mean(perc_dist))%>%
ungroup()
# i = 2
sub = levels(results_tbl$subject)[1]
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
summarise(perc_dist = mean(perc_dist))%>%
ungroup()
View(a2)
filter(results_tbl, subject == sub, target_distance == 2)
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
group_by(subject,condition, type) %>%
summarise(perc_dist = mean(perc_dist))%>%
ungroup()
View(a2)
a2 <- filter(results_tbl, subject == sub, target_distance == 2)%>%
group_by(subject,condition, type) %>%
summarise(perc_dist2 = mean(perc_dist))%>%
ungroup()
a6 <- filter(results_tbl, subject == sub, target_distance == 6)%>%
group_by(subject,condition, type) %>%
summarise(perc_dist6 = mean(perc_dist))%>%
ungroup()
a = merge(x = a6, y = a2, all.x = TRUE)
View(a)
a5 = merge(a,a)
a5 = merge(a,a, all = TRUE)
a5 = merge(a,a, all = TRUE)
a5 = merge(X = a, y =  a, all = TRUE)
aasd <- filter(results_tbl, subject == sub, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type) %>%
summarise(perc_dist6 = mean(perc_dist))%>%
ungroup()
aasd <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type) %>%
summarise(perc_dist6 = mean(perc_dist))%>%
ungroup()
View(aasd)
aasd <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist6 = mean(perc_dist))%>%
ungroup()
View(aasd)
rm(list=ls())
figures_folder = "figuras"
results_tbl <- read.csv("./DatosUnificados/Dresults_without_outliers_slope_and_intercepto_lin_log.csv", header = TRUE, sep = ',', stringsAsFactors = TRUE)
cbPalette <- c("#000000","#E69F00","#009E73", "#999999", "#D55E00", "#0072B2", "#CC79A7", "#F0E442")
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = mean(perc_dist))%>%
ungroup()
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(range = filter(results_tbl, target_distance == 6)-filter(results_tbl, target_distance == 2))%>%
ungroup()
results_tbl$target_distance == 6
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(range = results_tbl[results_tbl$target_distance == 6,] -results_tbl[results_tbl$target_distance == 2,])%>%
ungroup()
View(a1)
results_tbl[results_tbl$target_distance == 6,]
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
ungroup()
results_tbl[results_tbl$target_distance == 6,]
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(range = a1[a1$target_distance == 6,] -a1[a1$target_distance == 2,])%>%
ungroup()
a = a1[a1$target_distance == 6,]
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
ungroup()
a = a1[a1$target_distance == 6,]
a = a1[a1$target_distance == 6,]
a = a1[a1$target_distance == 2,]
a = a1[a1$target_distance == 6,]
a6 = a1[a1$target_distance == 6,]
a2 = a1[a1$target_distance == 2,]
a <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
ungroup()
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a2 = a1[a1$target_distance == 2,]
results_tblrange  = merge(a2,a6,all.x = TRUE)
View(results_tblrange)
View(results_tblrange)
View(a6)
View(a2)
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
ungroup()
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a2 = a1[a1$target_distance == 2,]
results_tblrange  = merge(a2,a6,all.x = TRUE)
View(results_tblrange)
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
install.packages("reshape")
library(reshape)
a6 = rename(a6, c(perc_dist="perc_dist6"))
View(a6)
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(perc_dist="perc_dist2"))
results_tblrange  = merge(a2,a6,all.x = TRUE)
View(results_tblrange)
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(perc_dist="perc_dist2"))
View(a6)
results_tblrange  = merge(a2,a6,all.x = TRUE)
View(results_tblrange)
results_tblrange  = merge(x = a2, y = a6, all.x = TRUE)
View(results_tblrange)
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(perc_dist="perc_dist2"))
results_tblrange  = merge(x = a2, y = a6, all.y = TRUE)
View(results_tblrange)
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(perc_dist="perc_dist2"))
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a6 = rename(a6, c(target_distance = "target_distance6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(target_distance = "target_distance2"))
results_tblrange  = merge(x = a2, y = a6, all.x = TRUE)
View(results_tblrange)
results_tblrange$range = results_tblrange$perc_dist6 -  results_tblrange$perc_dist2
results_tblrange$perc_dist6
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a6 = rename(a6, c(target_distance = "target_distance6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(target_distance = "target_distance2"))
results_tblrange  = merge(x = a2, y = a6, all.x = TRUE)
View(results_tblrange)
a1 <- filter(results_tbl, target_distance == 6| target_distance == 2)%>%
group_by(subject,condition, type, target_distance) %>%
summarise(perc_dist = perc_dist)%>%
ungroup()
a6 = a1[a1$target_distance == 6,]
a6 = rename(a6, c(perc_dist="perc_dist6"))
a6 = rename(a6, c(target_distance = "target_distance6"))
a2 = a1[a1$target_distance == 2,]
a2 = rename(a2, c(perc_dist="perc_dist2"))
a2 = rename(a2, c(target_distance = "target_distance2"))
results_tblrange  = merge(x = a2, y = a6, all.x = TRUE)
results_tblrange$range = results_tblrange$perc_dist6 -  results_tblrange$perc_dist2
results_tblp <- results_tblrange %>%
group_by(condition, type) %>%
summarise(mslope  = mean(range,na.rm=TRUE),
SDslope  = sd(range,na.rm=TRUE)/sqrt(length(range)))  %>%
ungroup()
f5 =  ggplot(results_tblp, aes(x = condition,y = mslope, colour = condition, fill = condition)) +
geom_pointrange(aes(x=condition, y=mslope, ymin=mslope-SDslope, ymax=mslope+SDslope),
position = position_dodgenudge(direction = "split", width = 3), size = 1.2, alpha=.5,shape = 0)+
geom_line(aes(group = type),position = position_dodgenudge(direction = "split", width = 3),size = 1.2)+
geom_point(data = results_tblrange, mapping = aes(x = condition,y = range, colour = condition, fill = condition), alpha = .8)+
geom_line(data = results_tblrange, mapping = aes(x = condition,y = range, group = subject, colour = condition, fill = condition),alpha = 0.3)+
scale_colour_manual(values = cbPalette) +
scale_fill_manual(values = cbPalette) +
geom_abline(slope = 0,
intercept = 0,
alpha = 0.5,
linetype = "dashed") +
labs(x = "Condition",
y = "Range rate") +
facet_grid(. ~ type) +
annotate("text", x = 1.5, y = 2,  label = "***", size = 4) +
annotate("segment", x = 1, xend = 2, y = 1.9, yend = 1.9, colour = "black", size=.5, alpha=1,)+
theme_pubr(base_size = 12, margin = TRUE)+
theme(legend.position = "none")
f5
